# MGWR 復現嘗試

## 檔案結構

- [`Main4.shp`](./Main4.shp) 為台北市 (約7000筆)
- [`Main5.shp`](./Main5.shp) 為台北市實驗區 (約100筆)
- [`Report.md`](./Report.md) MGWR產生報表
- [`MGWR.py`](./MGWR.py) 主程式
- [`exist.py`](./exist.py) Arcpy測試

## 報表

### 係數估計的統計摘要：
| 解釋變數 (標準化) | 平均值  | 標準差  | 最小值  | 中位數  | 最大值  |
|------------------|--------|--------|--------|--------|--------|
| 截距 (Scaled)    | -0.0050 | 0.3149 | -1.1777 | -0.0022 | 1.9704 |
| busC (Scaled)    | -0.1539 | 0.2081 | -3.3429 | -0.1644 | 1.7352 |
| metroC (Scaled)  | 0.1211  | 0.0003 | 0.1205  | 0.1211  | 0.1215 |
| bikeC (Scaled)   | 0.2322  | 0.0005 | 0.2311  | 0.2321  | 0.2330 |
| roadC (Scaled)   | 0.4421  | 0.1092 | -0.1106 | 0.4526  | 1.5665 |
| popDenC (Scaled) | 0.1678  | 0.0068 | 0.1605  | 0.1650  | 0.1800 |

---

### 模型診斷：
- **R-Squared**: 0.8991
- **Adjusted R-Squared**: 0.8800
- **AICc**: 6541.2567
- **Sigma-Squared**: 0.1200
- **Sigma-Squared MLE**: 0.1009
- **有效自由度 (Effective Degrees of Freedom)**: 5955.0022

---

### 解釋變數和鄰居總結：
| 解釋變數 (標準化) | 鄰居 (% of Features) | 顯著性 (% of Features) |
|-------------------|-----------------------|-----------------------|
| 截距 (Scaled)     | 30 (0.42%)            | 1084 (15.31%)         |
| busC (Scaled)     | 30 (0.42%)            | 2890 (40.81%)         |
| metroC (Scaled)   | 7082 (100%)           | 7082 (100%)           |
| bikeC (Scaled)    | 7082 (100%)           | 7082 (100%)           |
| roadC (Scaled)    | 30 (0.42%)            | 6369 (89.93%)         |
| popDenC (Scaled)  | 5417 (76.49%)         | 7082 (100%)           |

---

### 最佳帶寬搜索歷史：
| 迭代 | 截距 (Scaled) | busC (Scaled) | metroC (Scaled) | bikeC (Scaled) | roadC (Scaled) | popDenC (Scaled) | AICc         |
|------|---------------|---------------|-----------------|----------------|----------------|------------------|--------------|
| 1    | 30            | 30            | 7082            | 7082           | 4388           | 7082             | 7169.7451    |
| 2    | 30            | 30            | 7082            | 7082           | 30             | 5417             | 6541.2567    |

---

### 帶寬統計摘要：
| 解釋變數 (標準化) | 最佳鄰居數 | 有效參數數 | 調整後的 Alpha 值 | 調整後的 Pseudo-t 統計值臨界值 |
|------------------|------------|------------|------------------|--------------------------------|
| 截距 (Scaled)    | 30         | 569.60     | 0.0001           | 3.9248                         |
| busC (Scaled)    | 30         | 325.23     | 0.0002           | 3.7874                         |
| metroC (Scaled)  | 7082       | 1.01       | 0.0493           | 1.9667                         |
| bikeC (Scaled)   | 7082       | 1.04       | 0.0482           | 1.9757                         |
| roadC (Scaled)   | 30         | 229.03     | 0.0002           | 3.6991                         |
| popDenC (Scaled) | 5417       | 1.08       | 0.0461           | 1.9948                         |


## 已知 Bug

- 儲存Feature Class 會因為不明原因失敗
  
# 驗證方法檢討
![驗證方法](./val.jpg) 